<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elysia 3D</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: #000;
  }

  #scene {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  canvas {
    width: 100%;
    height: 100%;
    display: block;
  }

  /* 液态玻璃风格菜单按钮 */
  .menu-btn {
    position: fixed;
    top: 20px;
    right: 25px;
    width: 55px;
    height: 55px;
    border-radius: 15px;
    backdrop-filter: blur(12px);
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 4px 20px rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.8s ease;
    z-index: 10;
  }

  .menu-btn.show {
    opacity: 1;
  }

  .menu-btn span {
    width: 25px;
    height: 3px;
    background: rgba(255, 255, 255, 0.9);
    position: relative;
  }

  .menu-btn span::before,
  .menu-btn span::after {
    content: "";
    position: absolute;
    width: 25px;
    height: 3px;
    background: rgba(255, 255, 255, 0.9);
    left: 0;
    transition: 0.3s;
  }

  .menu-btn span::before {
    top: -8px;
  }

  .menu-btn span::after {
    top: 8px;
  }
</style>
</head>
<body>

<div id="scene"></div>
<div class="menu-btn"><span></span></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script>
  // ==== 基础设置 ====
  let scene = new THREE.Scene();
  let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  let renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.getElementById('scene').appendChild(renderer.domElement);

  // ==== 载入纹理 ====
  const loader = new THREE.TextureLoader();
  const colorMap = loader.load('assets/elysia.jpg');      // 改成你的原图路径
  const depthMap = loader.load('assets/elysia_depth.jpg'); // 改成你的深度图路径

  // ==== 着色器 ====
  const material = new THREE.ShaderMaterial({
    uniforms: {
      u_image: { value: colorMap },
      u_depth: { value: depthMap },
      u_mouse: { value: new THREE.Vector2(0.5, 0.5) }
    },
    vertexShader: `
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,
    fragmentShader: `
      uniform sampler2D u_image;
      uniform sampler2D u_depth;
      uniform vec2 u_mouse;
      varying vec2 vUv;
      void main() {
        float depth = texture2D(u_depth, vUv).r;
        vec2 offset = (u_mouse - vec2(0.5)) * 0.08 * (1.0 - depth);
        vec2 uv = vUv + offset;
        gl_FragColor = texture2D(u_image, uv);
      }
    `
  });

  const geometry = new THREE.PlaneGeometry(2, 1.1);
  const mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);
  camera.position.z = 1.5;

  // ==== 鼠标控制 ====
  document.addEventListener('mousemove', (e) => {
    material.uniforms.u_mouse.value.x = e.clientX / window.innerWidth;
    material.uniforms.u_mouse.value.y = 1.0 - e.clientY / window.innerHeight;
  });

  // ==== 渲染循环 ====
  function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
  }
  animate();

  // ==== 自适应 ====
  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

  // ==== 滚动时淡入按钮 ====
  const menuBtn = document.querySelector('.menu-btn');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 30) menuBtn.classList.add('show');
    else menuBtn.classList.remove('show');
  });
</script>

</body>
</html>